# vim

## vi/vim编辑器使用方法

**vi编辑器是所有Unix及Linux系统下标准的编辑器，相当于Windows的记事本。**

* vim具有程序编辑的能力，可以主动的以字体颜色辨别语法的正确性，方便程序设计；
* vim可以当作vi的升级版本，可以用多种颜色的方式来显示一些特殊信息；
* vim会依据文件扩展名或者文件内的开头信息，判断该文件的内容而自动的执行该程序的语法判断式，再以颜色来显示程序代码与一般信息；
* vim里面加入了很多额外的功能，例如支持正则表达式的搜索、多文件编辑、块复制等；

## 1. vi/vim是什么？

   1. Visual Interface，可视化接口
   2. vim是vi improve，vi的增强版（具有语法着色等功能）

## 2. vim模式有哪些？如何切换？

   ```mermaid
   graph TD
   命令模式/默认--a/i/o/s/r-->输入模式
   输入模式--esc-->命令模式/默认
   命令模式/默认--:-->末行模式
   末行模式--esc-->命令模式/默认
   ```
   
   > i  在当前光标所在字符的前面，转为输入模式
   >
   > I  在光标所在行的行首，转为输入模式
   >
   > a  在当前光标所在字符的后面，转为输入模式
   >
   > A  在光标所在行的行尾，转为输入模式
   >
   > o  在光标所在行的下方，新建一行，并转为输入模式
   >
   > O  在光标所在行的上方，新建一行，并转为输入模式
   >
   > s  删除光标所在字符
   >
   > r  替换光标处字符

## 3. 使用vim如何打开文件？

   vim /path  vim后跟文件路径及文件名，存在则打开，不存在则创建；

## 4. 如何关闭文件？

   * 末行模式：
     * w  保存
     * q  退出
     * wq  或  x  保存退出
     * q!  强制退出
     * w!  强制保存，管理员才有权限
   * 命令模式：
     * zz  保存并退出

## 5. 移动光标

   * 命令模式：
     1. 逐字符移动：
        * h  左（#h  表示移动#个字符）
        * l  右
        * j  下
        * k  上
     2. 以单词为单位移动：
        * w  移到下一个单词的词首（#w  表示移动#个单词）
        * e  跳至当前或下一个单词的词尾
        * b  跳至当前或上一个单词的词首
     3. 行内跳转：
        * 0  绝对行首
        * ^  行首第一个非空白字符
        * $  绝对行尾
     4. 行间跳转：
        * G  最后一行
        * #G 跳转到第#行

## 6. 翻屏：

   * 命令模式：
     * Ctrl + f  向下翻一屏
     * Ctrl + b  向上翻一屏
     * Ctrl + d  向下翻半屏
     * Ctrl + u  向上翻半屏

## 7. 删除：

   * 命令模式：

     1. 删除单个字符：

        1. x
        2. #x  删除#个字符

     2. 删除命令：d

        **d命令跟跳转命令组合使用，例：**

        * dw  表示删除光标所在位置到下一单词词首所有字符
        * #dw（#de  #db）  删除光标所在处及向后第#个单词词首所有字符
        * dd  删除当前光标所在行
        * #dd 删除包含当前光标所在行内的#行

   * 末行模式：

     1. StartADD，EndADDd  删除StartADD到EndADD位置的所有行，例如：10，15d：删除10到15行所有内容
     2. .d  删除光标所在行

## 8. 粘贴命令（p）：

   1. 命令模式：
      1. p  如果复制的为整行内容，则粘贴到光标所在行的**下方**，如果复制的内容为**非整行**，则粘贴至光标所在字符的**后面**
      2. P  如果复制的为整行内容，则粘贴到光标所在行的**上方**，如果复制或删除的内容为**非整行**，则粘贴至光标所在字符的**前面**

## 9. 复制命令（y）：

   **用法同d命令**

   1. 命令模式：
      1. yy  复制当前行
      2. yw（y#w,ye,y#e,yb,y#b）  复制光标当前位置到下个单词词首内容
      3. y#G  复制当前位置#行处的所有内容
   2. 末行模式：
      1. StartADD，EndADDy  复制StartADD到EndADD位置的所有行，例如：10，15d：复制10到15行所有内容
      2. +3y  复制当前位置向下3行

## 10. 修改（c）：

    **先删除内容，在转换为输入模式**

    1. c  用法同d

## 11. 替换（r）：

    1. r  单字符替换，替换光标选中字符
    2. R  替换模式

## 12. 撤销编辑操作（u：undo）；

    1. u  撤销前一次编辑操作
    2. #u  直接撤销#次操作
    3. Ctrl + r  撤销最近一次撤销操作

## 13. 重复前一次编辑操作

    1. .  比如上一次dd删除了一行，现在输入 . 就可以重复dd删除行的操作

## 14. 可视模式：

    1. 命令模式
       1. v  按字符选取，键盘控制光标选取 划过 的区域
       2. V  按矩形选取，键盘控制光标选取划过的行

## 15. 查找：

    1. 末行模式：
       * /PATHERN  从当前位置向后查找PATHERN 
       * ?PATTERN  从当前位置向前查找PATHERN
       * n  向下查找
       * N  向上查找

## 16. 查找并替换：

    1. 末行模式（s）：

       **ADDR1,ADDR2s/PATTERN/String/gi**

       * ADDR1,ADDR2 表示地址，$和%表示全文
       * g  表示全局替换
       * i  表示忽略大小写

## 17. vim打开多个文件：

    1. 末行模式：
       * :next  切换到下一个文件
       * :prev  切换到上一个文件
       * :last  切换到最后一个文件
       * :first 切换到第一个文件
       * :qa  退出全部文件

## 18. 分屏显示一个文件：

    1. vim打开文件后：
       * Ctrl + w,s  水平拆分窗口
       * Ctrl + w,v  垂直拆分窗口
    2. 在窗口间切换光标
       * Ctrl + w,ARROW
       * 比如  Ctrl+w,→（使用箭头方向键）  光标切换到右边的窗口
       * 比如  Ctrl+w,h(左), j(下), k(上), l(右)  也可以切换窗口
    3. 末行模式：
       * :qa  退出所有窗口

## 19. 分窗口编辑多个文件：

    * vim -o  水平分割显示
    * vim -O  垂直分割显示
    * 例如：**vim -o /etc/rc.sysinit /etc/inittab**  水平分割显示/etc/rc.sysinit和/etc/inittab 这2个文件

## 20. 将当前文件中部分内容保存为另外一个文件

    1. 末行模式：
       * w  表示保存当前文件
       * w /path/to/somewhere  将当前文件另存为到指定路径
       * ADDR1,ADDR2w /path/to/somewhere  将ADDR1到ADDR2指定的地址文本，另存为到指定路径

## 21. 将另一个文件的内容填充在当前文件中(r表示读):

    1. 末行模式：
       * **r  /path/to/somefile**  例如：输入 :r /etc/inittab，会将 inittab文件的所有内容附加到当前文件光标所在的位置

## 22. 跟shell交互（vim末行模式执行shell）

    1. 末行模式：
       * **! command**  例如：! ls /etc：列出/etc目录下所有文件及目录，按enter回到vim编辑状态

## 23. 高级话题：

    1. 末行模式：
       1. 显示或取消行号：
          * set nu（set number）  显示行号
          * set nonu  取消显示行号
       2. 忽略或区分字符大小写：
          * set ic（set ignorecase）  忽略大小写
          * set noignorecase  区分大小写
       3. 设定自动缩进：
          * set ai（set autoindent）  自动缩进
          * set noai  取消自动缩进
       4. 查找到的文本高亮或取消高亮显示：
          * set hlsearch 高亮显示搜索到的文本
          * set nohlsearch 取消高亮显示搜索到的文本
       5. 语法高亮：
          * syntax on  打开语法高亮显示
          * syntax off  关闭语法高亮显示

## 24. vim配置文件：

    * 全局vim配置文件：`/etc/vimrc`
    * 个人vim配置文件：`~/.vimrc`

